doctype html
html(lang="es")
    head
        title Secretaria - Reasignar Turno
        link(href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap", rel="stylesheet")
        link(rel="stylesheet" href="/css/secretariaGestionTurno.css")
        link(rel="stylesheet" href="/css/footerNuevo.css")
        link(rel="stylesheet" href="/css/headerSecretaria.css")
        link(rel="stylesheet" href="/css/secretariaTrasladarTurno.css")
        link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css")
        style.
            .info-turno-reasignar {
                background-color: #fff3cd;
                border-left: 4px solid #ffc107;
                padding: 15px;
                margin-bottom: 20px;
                border-radius: 5px;
            }
            .info-turno-reasignar h3 {
                margin-top: 0;
                color: #856404;
            }
            .info-turno-reasignar p {
                margin: 5px 0;
                color: #333;
            }
            .lista-profesionales {
                background-color: #e7f3ff;
                border: 1px solid #2196F3;
                padding: 15px;
                margin-bottom: 20px;
                border-radius: 5px;
                max-height: 200px;
                overflow-y: auto;
            }
            .lista-profesionales h4 {
                margin-top: 0;
                color: #0d47a1;
            }
            .lista-profesionales ul {
                list-style: none;
                padding: 0;
            }
            .lista-profesionales li {
                padding: 8px;
                margin: 5px 0;
                background-color: white;
                border-radius: 3px;
                border-left: 3px solid #2196F3;
            }
    body(class="secretariaTrasladarTurno")
        include ../includes/headerSecretaria
        main(class="mainContent")
            h1(class="titulo") üîÑ Reasignar Turno
            
            div.info-turno-reasignar
                h3 ‚ö†Ô∏è Turno por Reasignar
                p <strong>Paciente:</strong> #{turno.paciente_nombre}
                p <strong>Fecha original:</strong> #{turno.fechaFormateada}
                p <strong>Hora original:</strong> #{turno.hora}
                p <strong>Especialidad requerida:</strong> #{turno.especialidad}
                p <strong>Motivo:</strong> El profesional asignado fue dado de baja
            
            if profesionales && profesionales.length
                div.lista-profesionales
                    h4 üìã Profesionales disponibles con especialidad en #{turno.especialidad}:
                    ul
                        each prof in profesionales
                            li #{prof.nombre_completo} - Matr√≠cula: #{prof.matricula}
            else
                div.lista-profesionales
                    h4 ‚ö†Ô∏è No hay profesionales disponibles
                    p No se encontraron profesionales activos con la especialidad #{turno.especialidad} en esta sucursal.
            
            form(method="POST" action=`/turnos/reasignar/${turno.id}` class="formTurnos")
                h3 Selecciona el nuevo profesional y horario
                
                if profesionales && profesionales.length
                    select(name="profesional_especialidad_id_select" id="profesional" required class="profesionalSelect")
                        option(value="" selected disabled) Selecciona un profesional
                            each profesional in profesionales
                                option(value=profesional.profesional_especialidad_id)= `${profesional.nombre_completo} - ${profesional.especialidad}`
                    input(type="hidden" name="profesional_especialidad_id" id="profesional-id")
                else
                    p(class="noProfesionales") No se encontraron profesionales con esta especialidad
                
                label(for="fecha" class="fechaLabel") Selecciona la nueva fecha:
                input(type="text" name="fecha" id="fecha" required class="fechaInput" disabled)
                
                label(for="horario" class="horarioLabel") Selecciona un horario:
                select(name="hora" id="horario" required class="horarioSelect" disabled)
                    option(value="" selected disabled class="horarioOption") Selecciona un horario
                
                button(type="submit" class="btnTrasladar")  Reasignar Turno
            
            a(href="/turnos/listarTurnos" class="volver") ‚Üê Volver a turnos
        include ../includes/footer
        script(src="/js/logout.js")
        script(src="/js/horarios.js")
        script(src="https://cdn.jsdelivr.net/npm/flatpickr")
        script.
            // Sincronizar el select visible con el input oculto que usa horarios.js
            document.getElementById('profesional').addEventListener('change', function() {
                document.getElementById('profesional-id').value = this.value;
            });
