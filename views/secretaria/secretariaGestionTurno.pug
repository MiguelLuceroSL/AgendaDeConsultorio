doctype html
html
  head
    title Secretaria Panel
    link(href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap", rel="stylesheet")
    link(rel="stylesheet" href="/css/secretariaGestionTurno.css")
    link(rel="stylesheet" href="/css/footerNuevo.css")
    link(rel="stylesheet" href="/css/headerSecretaria.css")
    link(rel="stylesheet" href="/css/autocompletar_estilos.css")
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css")
  body
    include ../includes/headerSecretaria
    main(class="mainSecreGestionTurno")
      h2 Crear Turno
      form(action="/turnos/crear" method="POST" class="formTurnos" enctype="multipart/form-data") 
        h3 Buscar un Profesional
        .autocompletar_contenedor
          input(type="text" id="profesional-search" class="autocompletar_input" placeholder="Buscar por apellido o nombre..." autocomplete="off")
          input(type="hidden" name="profesional_especialidad_id" id="profesional-id" required)
        h3 Buscar un paciente
        .autocompletar_contenedor
          input(type="text" id="paciente-search" class="autocompletar_input" placeholder="Buscar por nombre o DNI..." autocomplete="off")
          input(type="hidden" name="paciente_id" id="paciente-id" required)
        label(for="fecha") Selecciona la fecha:
        input(type="text" name="fecha" id="fecha" required)
        label(for="horario") Selecciona un horario:
        select(name="hora" id="horario" required)
          option(value="" selected disabled) Selecciona un horario
        label(for="detalle_turno") Detalle del turno (opcional):
        textarea(name="detalle_turno" id="detalle_turno" rows="4" placeholder="Detalles adicionales del turno")
        input(type="hidden" name="es_sobreturno" id="es_sobreturno" value="0")
        input(type="hidden" name="estado" value="Confirmado")
        label(for="dni_foto") Subí la fotocopia del DNI (máx. 10MB):
        input(type="file" name="dni_foto" id="dni_foto" accept="image/jpeg,image/jpg,image/png,image/gif,image/webp" required)
        button(type="submit") Crear Turno
    include ../includes/footer
    script(src="/js/logout.js")
    script(src="/js/horarios.js")
    script(src="/js/autocompletar_paciente.js")
    script(src="/js/autocompletar_profesional.js")
    script(src="https://cdn.jsdelivr.net/npm/flatpickr")
    script.
      
      document.getElementById('dni_foto').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
          
          const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];
          if (!allowedTypes.includes(file.type)) {
            this.setCustomValidity('Solo se aceptan imágenes (JPEG, PNG, GIF, WEBP)');
            this.reportValidity();
            this.value = ''; 
            return;
          }
          
          
          const maxSize = 10 * 1024 * 1024; 
          if (file.size > maxSize) {
            this.setCustomValidity('El archivo es demasiado grande. El tamaño máximo es 10MB');
            this.reportValidity();
            this.value = ''; 
            return;
          }
          
          
          this.setCustomValidity('');
        }
      });
      
      // Inicializar autocompletados
      const autocompletarPaciente = new AutocompletarPaciente('paciente-search', 'paciente-id');
      const autocompletarProfesional = new AutocompletarProfesional('profesional-search', 'profesional-id');
